{% extends 'layouts/app.html.twig' %}

{% block title %}Discover Trails - WellCare Connect{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('trail-css') }}
    {{ encore_entry_link_tags('trail-maps-css') }}
{% endblock %}

{% block body %}
{# Page Header #}
<div class="py-4 mb-4 -mx-4 -mt-4 bg-wellcare-dark-500">
    <div class="px-4 mx-auto">
        <h1 class="mb-1 text-xl font-bold text-white font-display">
            <i class="mr-2 fa-solid fa-compass"></i>Discover Trails
        </h1>
        <p class="text-sm text-white/80">Find the perfect trail for your next health-focused adventure</p>
    </div>
</div>

{# Main Content #}
<div class="px-4 mx-auto" x-data="trailDiscovery()">
    <div class="flex flex-col gap-4 lg:flex-row">
        <!-- Filters Sidebar -->
        <div class="flex-shrink-0 lg:w-72">
            <div class="sticky bg-white border border-gray-100 shadow-sm dark:bg-gray-800 rounded-xl dark:border-gray-700 top-4">
                <div class="flex items-center justify-between p-3 border-b border-gray-100 dark:border-gray-700">
                    <h2 class="text-sm font-semibold text-gray-900 dark:text-white">
                        <i class="mr-2 fa-solid fa-filter text-wellcare-500"></i>Filters
                    </h2>
                    <button @click="resetFilters()" class="text-xs text-wellcare-500 hover:text-wellcare-600">Reset All</button>
                </div>
                
                <!-- Search -->
                <div class="p-3 border-b border-gray-100 dark:border-gray-700">
                    <label class="block mb-2 text-xs font-medium text-gray-700 dark:text-gray-300">Search</label>
                    <div class="relative">
                        <input type="text" x-model="filters.search" placeholder="Trail name, location..." 
                            class="w-full py-2 pl-8 pr-3 text-sm border border-gray-200 rounded-lg dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-wellcare-500 focus:border-transparent">
                        <i class="absolute text-gray-400 transform -translate-y-1/2 fa-solid fa-search left-2.5 top-1/2"></i>
                    </div>
                </div>

                <!-- Difficulty -->
                <div class="p-3 border-b border-gray-100 dark:border-gray-700">
                    <label class="block mb-2 text-xs font-medium text-gray-700 dark:text-gray-300">Difficulty</label>
                    <div class="space-y-1">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="easy" x-model="filters.difficulty" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300">Easy</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="moderate" x-model="filters.difficulty" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300">Moderate</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="hard" x-model="filters.difficulty" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300">Hard</span>
                        </label>
                    </div>
                </div>

                <!-- Distance -->
                <div class="p-3 border-b border-gray-100 dark:border-gray-700">
                    <label class="block mb-2 text-xs font-medium text-gray-700 dark:text-gray-300">Distance</label>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <span x-text="filters.distance[0] + ' km'"></span>
                            <span x-text="filters.distance[1] + ' km'"></span>
                        </div>
                        <input type="range" min="0" max="50" x-model="filters.distance[1]" 
                            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">
                        <div class="flex justify-between text-xs text-gray-400">
                            <span>0 km</span>
                            <span>50 km</span>
                        </div>
                    </div>
                </div>

                <!-- Amenities -->
                <div class="p-3">
                    <label class="block mb-2 text-xs font-medium text-gray-700 dark:text-gray-300">Amenities</label>
                    <div class="space-y-1">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="restrooms" x-model="filters.amenities" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300"><i class="mr-1 fa-solid fa-restroom"></i>Restrooms</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="parking" x-model="filters.amenities" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300"><i class="mr-1 fa-solid fa-parking"></i>Parking</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="water" x-model="filters.amenities" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300"><i class="mr-1 fa-solid fa-faucet"></i>Water Fountain</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" value="picnic" x-model="filters.amenities" 
                                class="w-3 h-3 border-gray-300 rounded text-wellcare-500 focus:ring-wellcare-500">
                            <span class="ml-2 text-xs text-gray-700 dark:text-gray-300"><i class="mr-1 fa-solid fa-utensils"></i>Picnic Area</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1">
            <!-- View Toggle & Results Count -->
            <div class="flex flex-col gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between">
                <p class="text-sm text-gray-600 dark:text-gray-400">
                    <span class="font-semibold text-gray-900 dark:text-white">24 trails</span> found near your location
                </p>
                <div class="flex items-center gap-2">
                    <div class="flex p-1 bg-gray-100 rounded-lg dark:bg-gray-800">
                        <button @click="viewMode = 'grid'" 
                            class="p-1.5 rounded-md transition"
                            :class="viewMode === 'grid' ? 'bg-white dark:bg-gray-700 shadow-sm text-wellcare-500' : 'text-gray-500 hover:text-gray-700'">
                            <i class="fa-solid fa-grid-2"></i>
                        </button>
                        <button @click="viewMode = 'list'" 
                            class="p-1.5 rounded-md transition"
                            :class="viewMode === 'list' ? 'bg-white dark:bg-gray-700 shadow-sm text-wellcare-500' : 'text-gray-500 hover:text-gray-700'">
                            <i class="fa-solid fa-list"></i>
                        </button>
                        <button @click="viewMode = 'map'" 
                            class="p-1.5 rounded-md transition"
                            :class="viewMode === 'map' ? 'bg-white dark:bg-gray-700 shadow-sm text-wellcare-500' : 'text-gray-500 hover:text-gray-700'">
                            <i class="fa-solid fa-map"></i>
                        </button>
                    </div>
                    <select x-model="sortBy" class="py-1.5 px-3 text-sm border border-gray-200 rounded-lg dark:border-gray-600 dark:bg-gray-700 dark:text-white">
                        <option value="popular">Most Popular</option>
                        <option value="rating">Highest Rated</option>
                        <option value="distance">Nearest</option>
                        <option value="recent">Recently Added</option>
                    </select>
                </div>
            </div>

            <!-- Grid View -->
            <div x-show="viewMode === 'grid'" class="grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3">
                <!-- Trail Card 1 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/1'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=200&fit=crop" alt="Forest Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-regular fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-wellcare-500 text-white rounded-full">Easy</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Forest Wellness Path</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>Central Park, Downtown</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>5.2 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>1h 30m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.9</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trail Card 2 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/2'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=200&fit=crop" alt="Mountain Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-solid fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-orange-500 text-white rounded-full">Moderate</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Summit View Trail</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>Mountain Ridge, North</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>8.4 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>3h 15m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.7</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trail Card 3 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/3'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=400&h=200&fit=crop" alt="Lake Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-regular fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-wellcare-500 text-white rounded-full">Easy</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Lakeside Serenity Loop</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>Blue Lake, Westside</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>6.1 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>1h 45m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.8</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trail Card 4 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/4'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400&h=200&fit=crop" alt="Canyon Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-regular fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-red-500 text-white rounded-full">Hard</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Canyon Adventure Trail</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>Red Canyon, East</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>12.3 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>5h 00m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.6</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trail Card 5 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/5'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=400&h=200&fit=crop" alt="River Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-solid fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-wellcare-500 text-white rounded-full">Easy</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Riverside Nature Walk</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>River Valley, South</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>3.8 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>1h 00m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.8</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trail Card 6 -->
                <div class="overflow-hidden transition bg-white border border-gray-100 shadow-sm cursor-pointer dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md" onclick="window.location.href='/trail/detail/6'">
                    <div class="relative h-36">
                        <img src="https://images.unsplash.com/photo-1519681393797-a1e288514c08?w=400&h=200&fit=crop" alt="Meadow Trail" class="object-cover w-full h-full">
                        <div class="absolute top-2 right-2">
                            <button class="p-1.5 bg-white/90 rounded-full hover:bg-white transition">
                                <i class="text-red-500 fa-regular fa-heart"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <span class="px-2 py-0.5 text-xs font-medium bg-orange-500 text-white rounded-full">Moderate</span>
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Wildflower Meadow Trail</h3>
                        <p class="mb-2 text-xs text-gray-500"><i class="mr-1 fa-solid fa-location-dot"></i>Hillside Meadows</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span><i class="mr-1 fa-solid fa-ruler"></i>7.2 km</span>
                                <span><i class="mr-1 fa-solid fa-clock"></i>2h 30m</span>
                            </div>
                            <div class="flex items-center">
                                <i class="mr-1 text-xs fa-solid fa-star text-amber-400"></i>
                                <span class="text-xs font-medium text-gray-700 dark:text-gray-300">4.9</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map View -->
            <div x-show="viewMode === 'map'" class="overflow-hidden bg-gray-100 dark:bg-gray-900 rounded-xl" style="height: 600px;">
                <div id="trail-map" class="w-full h-full"></div>
            </div>

            <!-- Pagination -->
            <div class="flex items-center justify-center gap-2 mt-6">
                <button class="px-3 py-1.5 text-sm border border-gray-200 rounded-lg dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
                <button class="px-3 py-1.5 text-sm bg-wellcare-500 text-white rounded-lg">1</button>
                <button class="px-3 py-1.5 text-sm border border-gray-200 rounded-lg dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">2</button>
                <button class="px-3 py-1.5 text-sm border border-gray-200 rounded-lg dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">3</button>
                <button class="px-3 py-1.5 text-sm border border-gray-200 rounded-lg dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">4</button>
                <button class="px-3 py-1.5 text-sm border border-gray-200 rounded-lg dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function trailDiscovery() {
    return {
        viewMode: 'grid',
        sortBy: 'popular',
        filters: {
            search: '',
            difficulty: [],
            distance: [0, 25],
            amenities: []
        },
        difficultyLevels: [
            { value: 'easy', label: 'Easy', count: 8 },
            { value: 'moderate', label: 'Moderate', count: 12 },
            { value: 'hard', label: 'Hard', count: 4 }
        ],
        resetFilters() {
            this.filters = {
                search: '',
                difficulty: [],
                distance: [0, 25],
                amenities: []
            };
        }
    }
}
</script>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
{% endblock %}
